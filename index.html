<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="x5-orientation" content="landscape" />
    <meta name="screen-orientation" content="landscape" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="full-screen" content="true" />
    <title>è¯—è¡Œå±±æ²³ - è·Ÿç€è¯—å¥æ¸¸ä¸­å›½</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/map.css" />
    <link rel="stylesheet" href="css/detail.css" />
    <link rel="stylesheet" href="css/pop.css" />
    <link rel="stylesheet" href="css/bgm-control.css" />
  </head>
  <body>
    <!-- å…¨å±€æ°´å¢¨é£å›¾æ ‡å’ŒBGMæ§åˆ¶ -->
    <div class="global-icon" id="bgmControl">
      <img src="images/icon/æ¼”å‡º.png" class="BGMon" style="display:none;"></img>
      <img src="images/icon/æ¼”å‡ºå…³é—­.png" class="BGMoff" style="display:block;"></img>
      <audio src="audio/effects/bgm.mp3" loop id="bgm"></audio>
    </div>
    

    <!-- BGMæ§åˆ¶è„šæœ¬ -->
    <script src="js/bgm-control.js"></script>
    
    <!-- æ¨ªå±å¼ºåˆ¶æç¤ºå±‚ -->
    <div id="orientation-prompt" style="
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 99999;
      font-size: 24px;
      text-align: center;
      display: none;
    ">
      <div style="transform: rotate(90deg); margin-bottom: 20px;">ğŸ“±</div>
      <p>è¯·å°†è®¾å¤‡æ—‹è½¬è‡³æ¨ªå±æ¨¡å¼</p>
      <p style="font-size: 16px; margin-top: 10px;">ä»¥è·å¾—æœ€ä½³ä½“éªŒ</p>
    </div>

    <!-- å±å¹•æ–¹å‘æ§åˆ¶ -->
    <script>
      // æ£€æµ‹è®¾å¤‡æ–¹å‘å˜åŒ–
      window.addEventListener('orientationchange', handleOrientationChange);
      window.addEventListener('resize', handleOrientationChange);
      window.addEventListener('load', handleOrientationChange);
      
      // è·å–æç¤ºå…ƒç´ 
      const orientationPrompt = document.getElementById('orientation-prompt');
      
      function handleOrientationChange() {
        // è·å–çª—å£å°ºå¯¸
        const width = window.innerWidth || document.documentElement.clientWidth;
        const height = window.innerHeight || document.documentElement.clientHeight;
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºæ¨ªå±æ¨¡å¼
        const isLandscape = width > height;
        
        // æ˜¾ç¤ºæˆ–éšè—æç¤ºå±‚
        if (!isLandscape) {
          orientationPrompt.style.display = 'flex';
        } else {
          orientationPrompt.style.display = 'none';
        }
        
        // å°è¯•é”å®šå±å¹•æ–¹å‘ä¸ºæ¨ªå±ï¼ˆæ”¯æŒä¸åŒæµè§ˆå™¨APIï¼‰
        try {
          if (screen.orientation && screen.orientation.lock) {
            screen.orientation.lock('landscape');
          } else if (screen.lockOrientation) {
            screen.lockOrientation('landscape');
          } else if (screen.mozLockOrientation) {
            screen.mozLockOrientation('landscape');
          } else if (screen.msLockOrientation) {
            screen.msLockOrientation('landscape');
          }
        } catch (e) {
          // é”å®šå¤±è´¥æ—¶ä¸åšå¤„ç†ï¼Œæç¤ºå±‚ä¼šç»§ç»­å·¥ä½œ
        }
        
        // å¼ºåˆ¶é¡µé¢å†…å®¹æ—‹è½¬å’Œç¼©æ”¾
        const htmlElement = document.documentElement;
        const bodyElement = document.body;
        
        if (!isLandscape) {
          // åœ¨ç«–å±ä¸‹å¼ºåˆ¶æ—‹è½¬å†…å®¹
          htmlElement.style.transform = 'rotate(90deg)';
          htmlElement.style.transformOrigin = '50% 50%';
          htmlElement.style.width = height + 'px';
          htmlElement.style.height = width + 'px';
          htmlElement.style.overflow = 'hidden';
          bodyElement.style.width = height + 'px';
          bodyElement.style.height = width + 'px';
        } else {
          // æ¢å¤æ­£å¸¸çŠ¶æ€
          htmlElement.style.transform = 'none';
          htmlElement.style.width = '100%';
          htmlElement.style.height = '100%';
          bodyElement.style.width = '100%';
          bodyElement.style.height = '100%';
        }
      }
      
      // åˆå§‹åŒ–æ—¶ç«‹å³æ£€æŸ¥æ–¹å‘
      handleOrientationChange();
    </script>
    
    <!-- å¼ºåˆ¶æ¨ªå±çš„CSS -->
    <style>
      /* åŸºç¡€æ ·å¼è®¾ç½® */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      html, body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        position: fixed;
        top: 0;
        left: 0;
      }
      
      /* å¼ºåˆ¶æ¨ªå±å¸ƒå±€ */
      @media screen and (max-width: 768px) and (orientation: portrait) {
        html {
          transform: rotate(90deg);
          transform-origin: 50% 50%;
          width: 100vh;
          height: 100vw;
          overflow: hidden;
        }
        
        body {
          width: 100vh;
          height: 100vw;
          overflow: hidden;
        }
      }
      
      /* ç¡®ä¿åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¿æŒæ¨ªå±ä½“éªŒ */
      @media screen and (orientation: portrait) {
        #orientation-prompt {
          display: flex !important;
        }
      }
      
      /* ç¡®ä¿æ‰€æœ‰é¡µé¢å®¹å™¨æ­£ç¡®æ˜¾ç¤º */
      .page {
        position: relative;
        width: 100%;
        height: 100%;
      }
    </style>
    
    <!-- æ¯›ç¬”é¼ æ ‡è·Ÿéšå…ƒç´  -->
    <div id="brush-cursor" style="position: fixed; pointer-events: none; z-index: 9999;">
      <img src="images/picture/image/æ¯›ç¬”.png" alt="æ¯›ç¬”" style="width: 40px; height: 40px; object-fit: contain;">
    </div>
    
    <!-- åŠ è½½é¡µé¢ -->
    <div id="loading-page" class="page active">
      <div class="logo">è¯—è¡Œå±±æ²³</div>
      <div class="subtitle">è·Ÿç€è¯—å¥æ¸¸ä¸­å›½ Â· ç©¿è¶Šåƒå¹´çš„æ–‡åŒ–ä¹‹æ—…</div>
      <div class="loading-bar">
        <div class="loading-progress" id="loading-progress"></div>
      </div>
    </div>
    
    <!-- æ¨¡æ¿ -->
    <template id="poemTemplate">
      <div class="poem-line"></div>
    </template>
    
    <!-- é¦–é¡µé¢ -->
    <div id="map-page" class="page">
      <div class="title-bar">
        <h1>è¯—è¡Œå±±æ²³</h1>
        <img src="images/picture/image/è¯—è¯å°ç« .png" alt="">
      </div>
      <div class="map-juanzhou">
        <img src="images/picture/image/å·è½´.webp" alt="">
      </div>
      <div class="open">
        <p>ç‚¹å‡»æ‰“å¼€å·è½´</p>
      </div>
    </div>

    <!-- è¯—å¥é€‰æ‹©é¡µé¢ -->
    <div id="poem-page" class="page"> 
      <div class="bg">
        <img src="images/picture/image/å·è½´å¼€.png" alt="">
      </div>
      <div class="shiju" id="shijuContainer"></div>
      <div class="back">
        <img src="images/picture/image/æ–‡å­—ç‚¹å‡»åº•å›¾.png" alt="">
        <p>ç‚¹å‡»å…³é—­å·è½´</p>
      </div>
    </div>

    <!-- å¤ä»Šå¯¹æ¯”é¡µ -->
     <div id="detail-page" class="page">
      <div class="poemDetail">
        <div class="back-button" id="backToPoem">
          <img src="images/picture/image/æ–‡å­—ç‚¹å‡»åº•å›¾.png" alt="è¿”å›">
          <p>è¿”å›</p>
        </div>
        <div class="switch">
          <img src="images/icon/å¤ä»Š.png" alt="å¤ä»Š">
          <p class="gujin"></p>
        </div>
        <div class="pgUp">
          <img src="images/icon/å·¦.png" alt="">
        </div>
        <div class="pgDown">
          <img src="images/icon/å³.png" alt="">
        </div>
        <!-- èƒŒæ™¯å›¾ç‰‡å®¹å™¨ -->
        <div class="image-container">
          <img src="" alt="å¤ä»£å›¾" class="ancient-img">
          <img src="" alt="ç°ä»£å›¾" class="modern-img">
        </div>
        <div class="leftTop">
          <div class="title">
            <!-- æ ‡é¢˜æ–‡æœ¬å°†é€šè¿‡JavaScriptåŠ¨æ€æ’å…¥ -->
            <div class="poemMusic">
              <img src="images/icon/è¯—è¯é™éŸ³.png" class="poemOff">
              <img src="images/icon/è¯—è¯å£°éŸ³.png" class="poemOn">
              <audio src="" id="poemAudio"> </audio>
            </div>
          </div>
          <div class="subTitle"></div>
          <div class="fullPoem"></div>
        </div>
        <div class="leftBottom">
          <img src="" alt="è¯—äºº" class="poet">
        </div>
        <div class="rightBottom">
          <div class="place-bar">
            <img src="images/icon/åæ ‡.png" alt="" class="building">
            <span class="placeName"></span>
          </div>
          <div class="position"></div>
          <hr>
          <div class="story"></div>
        </div>
      </div>
     </div>

     <!-- æ™¯åŒºå¼¹çª— -->
    <div class="pop">
      <div class="close">
        <img src="images/icon/å–æ¶ˆ.png" alt="" class="closepop">
      </div>
      <!-- å†…å®¹ -->
      <div class="place-content">
        <span class="placeName"></span>
        <hr>
        <div class="gushi"></div>
      </div>
      <!-- ç…§ç‰‡ -->
      <div class="place-picture">
        <!-- <p>æˆ‘å»</p> -->
        <img src="" alt="" class="p1"></img>
        <img src="" alt="" class="p2"></img>
        <img src="" alt="" class="p3"></img>
        <img src="" alt="" class="p4"></img>
      </div>
    </div>







    <!-- æ•°æ®æ–‡ä»¶ - ç›´æ¥åµŒå…¥JavaScriptä»¥é¿å…CORSé—®é¢˜ -->
    <script src="data/places.js"></script>
    
    <!-- <script src="js/utils.js"></script> -->
    <script src="js/poem.js"></script>
    <script src="js/map.js"></script>
    <script src="js/main.js"></script>
    <script src="js/poem-music.js"></script>
  </body>
</html>
